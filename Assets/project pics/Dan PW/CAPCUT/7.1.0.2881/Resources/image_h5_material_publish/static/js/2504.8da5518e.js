"use strict";(self.webpackChunkartist_op_web=self.webpackChunkartist_op_web||[]).push([[2504],{42245:(e,t,n)=>{n.d(t,{Jr:()=>i,OP:()=>c,Wr:()=>l,Yg:()=>r,cF:()=>a,x3:()=>s});var o=n(78159);const s=()=>(0,o.v_)("/lv/v1/ad_maker/user/get_enable_list",{}),i=e=>(0,o.v_)("/lv/v1/ad_maker/contract/country_code_list",e),r=()=>(0,o.v_)("/lv/v1/ad_maker/contract/dt_list",{}),a=async()=>{const{email:e}=await(0,o.v_)("/lv/v1/ad_maker/contract/get_binding_email",{});return e},c=e=>(0,o.v_)("/lv/v1/ad_maker/contract/create_common",e,{timeout:6e4}),l=()=>(0,o.v_)("/lv/v1/commerce/get_user_authorization")},48647:(e,t,n)=>{n.d(t,{$x:()=>f,AJ:()=>s,EO:()=>u,Js:()=>w,On:()=>l,TT:()=>_,U9:()=>m,Uz:()=>c,Xb:()=>I,Y$:()=>v,YC:()=>h,_K:()=>g,_M:()=>i,iu:()=>d,r0:()=>p,rz:()=>r,vW:()=>a});var o=n(78159);let s=function(e){return e[e.Video=1]="Video",e[e.Image=2]="Image",e[e.VodObject=7]="VodObject",e[e.Object=9]="Object",e}({});const i=e=>(0,o.v_)("/artist/v2/tools/get_upload_token",e),r=async()=>{const{user:e}=await(0,o.v_)("/lv/v1/user/web/get_user_info");return{nickname:e.nick_name,userID:e.user_id,avatarURL:e.avatar_urls.avatar_url_medium}},a=async()=>{const{region:e}=await(0,o.v_)("/lv/v1/get_region",{});return e},c=e=>(0,o.v_)("/artist/v1/tools/get_cv_tags",e,{onlyLogOnError:!0}),l=e=>(0,o.v_)("/artist/v1/tools/get_rec_tags",e,{onlyLogOnError:!0}),u=e=>(0,o.v_)("/artist/v1/tools/get_sug_tags",e,{onlyLogOnError:!0});let p=function(e){return e.UserPostPc="user_post_pc",e.UserPostPcCollection="user_post_pc_collection",e.UserPostPcSequence="user_post_pc_sequence",e.UserPostPcSequenceCollection="user_post_pc_sequence_collection",e.UserPostPcInTextTemplate="user_post_pc_in_text_template",e.UserPostPcInTextTemplateSequence="user_post_pc_in_text_template_sequence",e.UserPostPcMultiLangTextTemplate="user_post_pc_ml_text_template",e.UserPostPcInMultiLangTextTemplate="user_post_pc_in_ml_text_template",e.UserPostPcNewTool="user_post_pc_new_tool",e}({}),d=function(e){return e.Open="open",e.Targeted="targeted",e}({}),f=function(e){return e[e.Vip=1]="Vip",e[e.Business=2]="Business",e}({}),m=function(e){return e[e.Unauthorized=0]="Unauthorized",e[e.Authorized=1]="Authorized",e}({});const _=e=>(0,o.v_)("/artist/v1/post/effect",e),v=e=>(0,o.v_)("/artist/v1/effect/update",e),h=async()=>await(0,o.v_)("/lv/v1/user/get_enable_list",{});let I=function(e){return e[e.Tag=1]="Tag",e}({});const g=async e=>(0,o.v_)("/artist/v1/tools/check_antidirt",e),w=e=>(0,o.v_)("/artist/v1/homepage/get_effect_list",e)},71157:(e,t,n)=>{n.d(t,{appModel:()=>l});var o=n(88154),s=n(60963),i=n(83617),r=n(52272),a=n(83305),c=n(83372);const l=new class{constructor(){(0,o.Z)(this,"appInfo",{language:"",appID:"",region:"",appVersion:"",appVersionName:void 0,currentScene:"",did:""}),(0,o.Z)(this,"debugInfo",{useBOE:!1,boeChannel:"",usePPE:!1,ppeChannel:""}),(0,o.Z)(this,"isInitFailed",!1),(0,o.Z)(this,"isInited",!1),(0,o.Z)(this,"initAppInfoPromise",null),(0,s.ky)(this)}async initAppInfo(){return this.isInitFailed=!1,this.initAppInfoPromise||(this.initAppInfoPromise=this.initAppInfoImpl().catch((e=>{throw this.initAppInfoPromise=null,e}))),this.initAppInfoPromise}async initAppInfoImpl(){console.log("start");try{const e=await(0,r.BN)();if((0,s.z)((()=>{this.appInfo={...e,appVersionName:this.getAppVersionName(e.appVersion)}})),console.log("done appInfo",e.language,e.appID,e.region),(0,a.$G)({deviceId:this.appInfo.did,ctx:{appVersion:this.appInfo.appVersionName,os:e.os,osVersion:e.osVersion,language:this.appInfo.language,region:this.appInfo.region}}),"undefined"!=typeof window){const e="lvoverseas_web";"function"==typeof window.Slardar&&window.Slardar("context.set","appxpcode",e),"function"==typeof window.slardar&&window.slardar("context.set","appxpcode",e)}(0,c.w)({fallbackHash:"bfd6e1ae3f60e599efaf26a8d39d56f0",lazyUpdate:!0})}finally{await i.ZP.changeLanguage({locale:this.appInfo.language})}return this.appInfo}getAppVersionName(e){const t=Number.parseInt(e,10);if(!t)return;const n=Math.floor(t/Math.pow(256,2)),o=t-n*Math.pow(256,2),s=Math.floor(o/256);return`${n}.${s}.${o-256*s}`}setInitFailed(){this.isInitFailed=!0}setInited(){this.isInited=!0}async initDebugInfo(){}}},1234:(e,t,n)=>{n.d(t,{$:()=>u});var o=n(88154),s=n(60963),i=n(83305),r=n(52272),a=n(71157),c=n(48647),l=n(42245);const u=new class{constructor(){(0,o.Z)(this,"userInfo",{avatar:"",nickname:"",uid:""}),(0,o.Z)(this,"permissions",[]),(0,o.Z)(this,"isEnableAuthorization",!1),(0,o.Z)(this,"initUserInfoPromise",null),(0,s.ky)(this)}async initUserInfo(){return this.initUserInfoPromise||(this.initUserInfoPromise=this.initUserInfoImpl().catch((e=>{throw this.initUserInfoPromise=null,e}))),this.initUserInfoPromise}async refreshUserInfo(){return a.appModel.isInited?this.initUserInfoImpl():this.initUserInfo()}async initUserInfoImpl(){var e;const t=await(0,r.bG)().catch((()=>null));if(!1===(null==t?void 0:t.hasLoggedIn))return(0,s.z)((()=>{this.userInfo.avatar="",this.userInfo.nickname="",this.userInfo.uid="",this.permissions=[],this.isEnableAuthorization=!1})),void(0,i.$G)({userId:""});null!=t&&t.hasLoggedIn&&null!==(e=t.userInfo)&&void 0!==e&&e.userID&&((0,s.z)((()=>{this.userInfo.uid=t.userInfo.userID,this.userInfo.avatar=t.userInfo.avatarURL,this.userInfo.nickname=t.userInfo.nickname})),(0,i.$G)({userId:this.userInfo.uid}));const n=c.rz,[o,a]=await Promise.all([n(),(0,c.YC)()]);(0,s.z)((()=>{var e;null!=o&&o.userID&&(this.userInfo.uid=o.userID,this.userInfo.nickname=o.nickname,this.userInfo.avatar=o.avatarURL),this.permissions=(null===(e=a.enable_list)||void 0===e||null===(e=e.filter((e=>e.is_enable)))||void 0===e?void 0:e.map((e=>e.whitelist_type)))||[]}));{const e=await(0,l.Wr)();(0,s.z)((()=>{this.isEnableAuthorization=e.allow_pro_template_auto_transition}))}(0,i.$G)({userId:this.userInfo.uid})}}},40358:(e,t,n)=>{n.d(t,{Wq:()=>l,ZP:()=>u,cb:()=>c});n(60191);var o=n(73994),s=n(71157),i=n(1234),r=n(36958),a=n(83305);async function c(e){try{await s.appModel.initAppInfo(),await i.$.initUserInfo(),s.appModel.setInited()}catch(t){if((0,a.RF)("initAppAndUserInfo failed",t),s.appModel.setInitFailed(),null!=e&&e.throwOnError)throw t}}async function l(){try{await s.appModel.initAppInfo()}catch(e){(0,a.RF)("tryInitCoreAppInfo failed",e),s.appModel.setInitFailed()}}function u(){document.oncontextmenu=()=>!1,document.ondragover=e=>e.preventDefault(),document.ondrop=e=>e.preventDefault(),document.addEventListener("keydown",(e=>{("w"===e.key&&e.metaKey||"w"===e.key&&e.ctrlKey)&&e.preventDefault()}));const e=(0,r.c)()?o.i.macos:o.i.windows;document.body.classList.add(e),s.appModel.initDebugInfo(),c()}},83305:(e,t,n)=>{n.d(t,{$G:()=>m,RF:()=>l,c6:()=>c,hC:()=>_});var o=n(7142),s=n(41723),i=n.n(s);const r=()=>i()().format("MM-DD HH:mm:ss.SSSZ");function a(e,t){try{var n,o;const s=String(e).trim(),i=null!==(n=null===(o=s.match(/^\[\w+\]/))||void 0===o?void 0:o[0])&&void 0!==n?n:"",r=i.slice(1,-1),a=s.slice(i.length).replace(/\{\S*?\}/g,"").trim().replace(/[\s:-]+/g,"-");return{module:r,scene:t.scene?`${a}-${t.scene}`:a}}catch(s){return{module:"",scene:t.scene||""}}}async function c(e,t){const n=`${r()} ${e}`,{module:s,scene:i}=a(e,{...t}),c={...t,module:s,scene:i};(0,o.Z)("sendLog",{level:"info",content:n,extra:c})}async function l(e,t,n){const s="HeycanError"===(null==t?void 0:t.name)?t.context:t;t&&(0,o.Z)("captureException",t,{...s,...n});const i=`${r()} ${e}`,{module:c,scene:l}=a(e,{...s,...n}),u={stack:null==t?void 0:t.stack,message:null==t?void 0:t.message,...s,...n,module:c,scene:l};(0,o.Z)("sendLog",{level:"error",content:i,extra:u}),console.error(`[slardar] ${i}`,{...u}),t&&console.error(t)}const u=[],p=1e3;function d(e){const t=e.post;e.post=n=>{const{success:o,fail:s}=n;t({...n,success:t=>{(()=>{if(0===u.length)return;const t=u.shift();t&&e.post(t)})(),null==o||o(t)},fail:e=>{u.push(n),u.length>p&&u.shift(),null==s||s(e)}})}}let f=!1;function m(e){f||(f=!0,o.Z.on("init",(()=>{var e;const t=null===(e=o.Z.config())||void 0===e?void 0:e.transport;t&&d(t)})));const{ctx:t,...n}=e;(0,o.Z)("config",n),t&&o.Z.context&&(0,o.Z)("context.merge",t)}function _(e){const{module:t,scene:n,metrics:s,categories:i}=e;(0,o.Z)("sendEvent",{name:"heycan_performance_timing",metrics:s,categories:{...i,module:t,scene:n}})}},12803:(e,t,n)=>{n.d(t,{B:()=>s});var o=n(88154);class s{constructor(){(0,o.Z)(this,"timeoutHandle",null)}timeout(e){return this.cancel(),new Promise((t=>{this.timeoutHandle=setTimeout((()=>{this.timeoutHandle=null,t()}),e)}))}cancel(){this.timeoutHandle&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null)}hasTimeout(){return null!==this.timeoutHandle}}},99326:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(57102),s=Object.defineProperty,i=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,p=(e,t)=>{for(var n in t||(t={}))c.call(t,n)&&u(e,n,t[n]);if(a)for(var n of a(t))l.call(t,n)&&u(e,n,t[n]);return e};const d={version:void 0};var f=(e,t={})=>{return o.Z.call("publishEvent",e,(n=p({},t),s={customOptions:p({jsb_rules:d},t.customOptions)},i(n,r(s))));var n,s}},5795:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(57102),s=Object.defineProperty,i=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,p=(e,t)=>{for(var n in t||(t={}))c.call(t,n)&&u(e,n,t[n]);if(a)for(var n of a(t))l.call(t,n)&&u(e,n,t[n]);return e};const d={version:void 0};var f=(e,t={})=>{return o.Z.call("setNeedConfirmModalOnClose",e,(n=p({},t),s={customOptions:p({jsb_rules:d},t.customOptions)},i(n,r(s))));var n,s}}}]);