"use strict";(self.webpackChunkartist_op_web=self.webpackChunkartist_op_web||[]).push([[5621],{79337:(e,t,s)=>{s.d(t,{EG:()=>p.Z,Ex:()=>u.Z,FN:()=>g.Z,Form:()=>v.Z,II:()=>i.Z,J2:()=>o.Z,Kx:()=>c.Z,Lt:()=>a.Z,Q2:()=>h.Z,Vp:()=>m.Z,XQ:()=>Z.Z,XZ:()=>r.ZP,ih:()=>x.i,u:()=>f.Z,u_:()=>l.Z,yC:()=>d.Z,zx:()=>n.Z});s(4037);var n=s(46995),r=s(47225),l=s(49576),a=s(34072),i=s(99373),c=s(61162),o=s(28246),u=s(50382),d=s(72271),m=s(41986),p=s(81884),g=s(34994),f=s(39362),v=s(42915),Z=s(56475),h=s(95113),x=s(38823)},49479:(e,t,s)=>{s.d(t,{Z:()=>c});s(18571);var n=s(18751),r=s.n(n),l=s(79337),a=s(80697),i=s(72322);const c=({className:e,value:t,selected:s,disabled:n,onClick:c})=>(0,i.jsx)(l.Vp,{className:r()(e,a.Z.tag,s&&a.Z.selected,n&&a.Z.disabled),color:s?"cyan":void 0,onClick:()=>null==c?void 0:c(t),children:t},t)},57939:(e,t,s)=>{s.d(t,{Z:()=>u});var n=s(18571),r=s(18751),l=s.n(r),a=s(79337),i=s(49479),c=s(6059),o=s(72322);const u=({className:e,title:t,loading:s,loadingText:r,value:u,options:d,onSelect:m})=>{const p=(0,n.useCallback)((e=>u.includes(e)),[u]),g=(0,n.useMemo)((()=>d.filter((e=>!u.includes(e)))),[u,d]);return 0===g.length?null:(0,o.jsxs)("div",{className:l()([c.Z.block,e]),children:[(0,o.jsx)("p",{className:c.Z.title,children:t}),(0,o.jsx)("div",{className:c.Z.content,children:s?(0,o.jsxs)("div",{className:c.Z.loading,children:[(0,o.jsx)("span",{className:c.Z.text,children:r}),(0,o.jsx)(a.yC,{size:"small"})]}):g.map((e=>(0,o.jsx)(i.Z,{selected:p(e),value:e,onClick:()=>m(e)},e)))})]})}},45328:(e,t,s)=>{s.d(t,{Z:()=>u});var n=s(18571),r=s(65625),l=s(42716),a=s(1234),i=s(40706),c=s(57939),o=s(72322);const u=(0,r.Pi)((({value:e,onSelect:t})=>{const[s,r]=(0,n.useState)([]),{t:u}=(0,l.$)();return(0,n.useEffect)((()=>{const e=(0,i.cF)(i.Qt.TagEachUser,a.$.userInfo.uid).get();r(e)}),[a.$.userInfo.uid,e]),(0,o.jsx)(c.Z,{title:u("pc_recently_used_web"),value:e,options:s,onSelect:t})}))},3502:(e,t,s)=>{var n=s(18571),r=s(65625),l=s(54275),a=s(61458),i=s(42716),c=s(57939),o=s(48647),u=s(72322);(0,r.Pi)((({title:e,uri:t,value:s,itemType:r,onSelect:d})=>{const[m,p]=(0,n.useState)([]),[g,f]=(0,n.useState)([]),[v,Z]=(0,n.useState)(!1),h=(0,n.useRef)({selfConfigTagsReady:{}}),{t:x}=(0,i.$)(),w=(0,n.useMemo)((()=>[...g,...m]),[m,g]),_=(0,l.Z)((e=>{const{title:t,uri:s}=e;return t?h.current.cvid&&h.current.uri===s?{cvid:h.current.cvid,title:t}:s?{image_uri:s,title:t}:null:null})),b=(0,n.useCallback)((async()=>{try{Z(!0);const s=_({title:e,uri:t});await Promise.all([s&&(0,o.Uz)(s).then((e=>{f(e.cv_tags),h.current.cvid=e.cvid,s.image_uri&&(h.current.uri=s.image_uri)})),!h.current.selfConfigTagsReady[r]&&(0,o.On)({effect_type:r}).then((e=>{p(e.rec_tags),h.current.selfConfigTagsReady[r]=!0}))])}finally{Z(!1)}}),[e,t,r]);return(0,a.Z)(b,500,[b]),(0,n.useEffect)((()=>{b()}),[r]),(0,u.jsx)(c.Z,{title:x("recommend_signature_web"),loading:v,loadingText:x("loading_web"),value:s,options:w,onSelect:d})}))},45220:(e,t,s)=>{s.d(t,{u:()=>b});var n=s(18571),r=s(95291),l=s(79337),a=s(54275),i=s(61458),c=s(42716),o=s(65625),u=s(1234),d=s(40706),m=s(15621),p=s(83305),g=s(13928),f=s(48647),v=s(66795),Z=s(45328),h=(s(3502),s(49479)),x=s(95331),w=s(72322);const _=(0,o.Pi)((({recommendConfig:e,value:t=[],itemType:s,disabled:o,disableRecommend:_,disableLatest:b,onChange:E,placeholder:y,max:N=15,temporaryId:S,ignoreAddTagOnBlurSelector:j,onRecentTagSelect:I})=>{const T=(0,n.useRef)(!1),[k,R]=(0,n.useState)(""),[L,M]=(0,n.useState)(""),C=(0,n.useRef)(!1),A=C.current?L:k,[q,P]=(0,n.useState)([]),[F,U]=(0,n.useState)([]),{t:$}=(0,c.$)(),O=e=>(0,d.cF)(d.Qt.TagEachUser,u.$.userInfo.uid).set("add",[e]),D=(0,a.Z)((e=>{U(k?e:[])}));(0,i.Z)((async()=>{if(!s||!k)return;const e=await(0,f.EO)({query:k,count:10}),t=(null==e?void 0:e.sug_tags)||[];D(t)}),500,[k,s]),(0,n.useEffect)((()=>{k||U([])}),[k]);const B=(0,n.useCallback)((e=>{if(N&&e.length>N)return l.FN.error($("pc_stickers_release_max_tag_web",{X:N})),void(null==E||E(e.slice(0,N)));null==E||E(e)}),[E]),Q=(0,a.Z)((e=>{t.includes(e)||B([...t,e])})),J=(0,n.useMemo)((()=>new m.l),[]),V=(0,a.Z)((async e=>{const s=await J.lock("",(async()=>{if(t.includes(e))return!0;let s=!1;try{const t=await(0,f._K)({words:e,scene:f.Xb.Tag});s=!1===(null==t?void 0:t.is_hit)}catch(n){return(0,p.RF)("[TagSelect] call checkAntiDirt failed",n,{tag:e}),l.FN.error($("pc_tag_retry_web")),!1}return s?(Q(e),!0):((0,p.c6)("[TagSelect] checkAntiDirt not passed",{tag:e}),l.FN.error($("pc_tag_illegal_fail_web")),!1)}));return null!=s&&s})),z=(0,a.Z)((e=>{if(0===e.length)return;const s=t.filter((t=>!e.includes(t)));B(s)})),X=(0,n.useRef)(null),{saveSelectionIfNeeded:G}=(0,v.u)({getInputElem:()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.inputRef.current}}),K=e=>{const t=(0,g.aF)(e,30);G(t),R(t)},Y=(0,a.Z)((e=>{K(""),t.includes(e)?z([e]):(Q(e),O(e))})),H=e=>{const t=q.includes(e);P(t?q.filter((t=>t!==e)):[...q,e])},W=(0,a.Z)((()=>{z(q),P([])})),ee=(0,a.Z)((()=>X.current&&X.current.inputRef.current&&X.current.tagInputRef.current?{tagInput:X.current,tagInputElem:X.current.tagInputRef.current,inputElem:X.current.inputRef.current}:null)),te=(0,a.Z)((e=>{const t=ee();return!!(t&&e&&e instanceof Element)&&e.closest(".semi-tagInput")===t.tagInputElem})),se=(0,a.Z)((e=>!!(e&&e instanceof Element)&&null!==e.closest(".semi-tag"))),ne=(0,a.Z)((e=>{const t=e.target,s=ee();if(!s||!te(t))return;const{tagInput:n,tagInputElem:r,inputElem:l}=s,{selectionStart:a,selectionEnd:i}=l;return q.length>0&&se(t)?(W(),null==l||l.setSelectionRange(0,0),void n.focus()):void 0})),re=(0,a.Z)((e=>{const t=e.target;ee()&&te(t)&&se(t)&&(te(e.relatedTarget)&&se(e.relatedTarget)||P([]))}));(0,n.useEffect)((()=>{const e=e=>{"Delete"===e.code||"Backspace"===e.code?(T.current=!0,ne(e)):T.current=!1};return window.addEventListener("keydown",e,!0),window.addEventListener("blur",re,!0),()=>{window.removeEventListener("keydown",e,!0),window.removeEventListener("blur",re,!0)}}),[]);const le=(0,a.Z)((e=>{e.replace(/ {1,}/g,"")===k.replace(/ {1,}/g,"")&&K("")})),ae=async e=>{const[t]=e;Promise.resolve().then((()=>K(k)));const s=t.replace(/ {1,}/g,"");if(0===s.length)return;await V(s)&&(O(s),le(k))},ie=async e=>{if(C.current)return void M(e);const t=e.replace(/ {1,}$/,""),s=t.replace(/ {1,}/g,"");if(K(t),t===e||!t||T.current)return;await V(s)&&(O(s),le(k))};(0,n.useEffect)((()=>{var e;const t=null===(e=X.current)||void 0===e?void 0:e.inputRef.current;if(!t)return;const s=()=>{C.current=!0,M(t.value)},n=()=>(0,r.unstable_batchedUpdates)((()=>{C.current=!1,M(""),ie(t.value)}));return t.addEventListener("compositionstart",s),t.addEventListener("compositionend",n),()=>{t.removeEventListener("compositionstart",s),t.removeEventListener("compositionend",n)}}),[]);(0,n.useEffect)((()=>{S&&R("")}),[S]);return(0,w.jsxs)("div",{className:x.Z.tagSelect,children:[(0,w.jsx)(l.Lt,{position:"bottomLeft",trigger:"focus",className:x.Z.suggestListDropdown,style:{maxHeight:200,overflow:"scroll"},render:(0,w.jsx)(l.Lt.Menu,{children:F.map((e=>(0,w.jsx)(l.Lt.Item,{className:x.Z.dropItem,onClick:()=>Y(e),children:e},e)))}),children:(0,w.jsx)(l.EG,{ref:X,inputValue:A,onInputChange:ie,value:t,placeholder:y,renderTagItem:(e,t,s)=>(0,w.jsx)(h.Z,{value:e,selected:q.includes(e),disabled:o,onClick:H},e),onAdd:ae,onBlur:e=>{if(e.relatedTarget&&e.relatedTarget instanceof Element){const t=[`.${x.Z.suggestListDropdown}`,j].filter((e=>e)).join(",");if(null!==e.relatedTarget.closest(t)||se(e.relatedTarget))return}ae([k])},disabled:o})}),!1,!o&&!b&&(0,w.jsx)(Z.Z,{value:t,onSelect:e=>{Y(e),null==I||I()}})]})})),b=(0,l.Q2)(_)},10806:(e,t,s)=>{s.d(t,{S8:()=>r});var n=s(54290);n.Ab.Emoticons,n.Ab.Sticker,n.Ab.StickerCollection,n.Ab.Filter,n.Ab.FilterCollection,n.Ab.Video,n.Ab.AudioEffect;const r=40},68288:(e,t,s)=>{s.d(t,{ir:()=>x});var n=s(18571),r=s(18751),l=s.n(r),a=s(42716),i=s(12247),c=s(77991),o=s(92644),u=s(17150),d=s(37964),m=s(71410),p=s(7890),g=s(72322);const f=e=>{const{className:t,loadingText:s}=e,{t:n}=(0,a.$)(),{handleMouseEnter:r}=(0,d.S)();return(0,g.jsxs)("div",{className:l()(p.Z.root,t),children:[(0,g.jsx)(u.a,{className:p.Z.icon,size:12,arcColor:"var(--grey-1)"}),(0,g.jsx)("div",{className:p.Z.text,onMouseEnter:r,children:s||n("pc_stickers_release_in_web")})]})},v=e=>{const{className:t,tooltip:s}=e,{t:r}=(0,a.$)(),{handleMouseEnter:c}=(0,d.w)({content:s,className:p.Z.tooltip}),o=(0,n.useRef)(null),{setIsMarqueeLoopRunning:u,reactNode:f}=(0,m.J)({text:r("pc_stickers_release_invalid_web"),gap:16,getEllipsisDOM:()=>o.current});return(0,g.jsxs)("div",{className:l()(p.Z.root,t,p.Z.error),onMouseEnter:e=>{u(!0),c(e)},onMouseLeave:()=>u(!1),children:[(0,g.jsx)(i.r,{className:p.Z.icon}),(0,g.jsx)("div",{ref:o,className:p.Z.text,children:f})]})},Z=e=>{const{className:t,text:s}=e,{handleMouseEnter:n}=(0,d.S)();return(0,g.jsxs)("div",{className:l()(p.Z.root,t,p.Z.checked),children:[(0,g.jsx)(o.r,{className:p.Z.icon}),(0,g.jsx)("div",{className:p.Z.text,onMouseEnter:n,children:s})]})},h=e=>{const{className:t}=e,{t:s}=(0,a.$)(),{handleMouseEnter:n}=(0,d.S)();return(0,g.jsxs)("div",{className:l()(p.Z.root,t),children:[(0,g.jsx)("div",{className:l()(p.Z.icon,p.Z.yellowIcon),children:(0,g.jsx)("div",{className:p.Z.yellowPoint})}),(0,g.jsx)("div",{className:p.Z.text,onMouseEnter:n,children:s("pc_stickers_release_editing_web")}),(0,g.jsx)(c.r,{className:p.Z.icon})]})},x=e=>{const{className:t,loading:s,invalid:n,errorToolip:r,isInfoComplete:l,title:a,loadingText:i}=e;return s?(0,g.jsx)(f,{className:t,loadingText:i}):n?(0,g.jsx)(v,{className:t,tooltip:r}):l?(0,g.jsx)(Z,{className:t,text:a}):(0,g.jsx)(h,{className:t})}},85108:(e,t,s)=>{s.d(t,{Z:()=>m,f:()=>u});var n=s(88154),r=s(31062),l=s(7561),a=s(1234),i=s(83305),c=s(12803),o=s(48647);const u=10;function d(e){return Boolean(e.id)}class m{constructor(){(0,n.Z)(this,"itemMap",new Map)}getPublishInfo(e){return this.itemMap.get(e)}async batchPublish(e){const t=[];for(const s of(0,r.Z)(e,u)){const e=await Promise.all(s.map((e=>this.publish(e))));t.push(...e)}return t}async publish(e){var t;const{id:s,onResult:n,onUpdateResult:r}=e,a=JSON.parse(JSON.stringify(e.req));let c=this.itemMap.get(s);if(null!==(t=c)&&void 0!==t&&t.promise&&(0,l.Z)(c.req,a))try{return await c.promise}catch(o){(0,i.c6)("[MaterialPublishService] publish failed, start to retry",{id:s})}return c={promise:null,id:s,req:a,onResult:n,onUpdateResult:r},this.itemMap.set(s,c),c.promise=this.publishImpl(c),c.promise}getErrorText(e){return e?e.message||JSON.stringify(e):""}async publishImpl(e){const t=performance.now(),s=async(s,n)=>{try{const a={error:s,errorText:this.getErrorText(s),time:Math.round(performance.now()-t),resourceId:n};var r,l;if(d(e.req))await(null===(r=e.onUpdateResult)||void 0===r?void 0:r.call(e,{req:e.req,...a}));else await(null===(l=e.onResult)||void 0===l?void 0:l.call(e,{req:e.req,...a}))}catch(a){(0,i.RF)("[MaterialPublishService] callOnResult failed",a)}};let n;try{n=await this.postOrUpdate(e)}catch(r){throw e.promise=null,s(r,""),r}return await s(null,n.resource_id),n}async postOrUpdate(e){return d(e.req)?(await(0,o.Y$)(e.req),{resource_id:e.req.id,source:1}):(0,o.TT)(e.req)}async pollUntilAllInEffectList(e){try{await Promise.race([this.pollUntilAllInEffectListImpl(e),(new c.B).timeout(5e3)])}catch(t){(0,i.RF)("[MaterialPublishService] pollUntilAllInEffectList failed",t)}}async pollUntilAllInEffectListImpl({ids:e,types:t}){const s=performance.now(),n=new c.B,r={count:50,effect_types:t,uid:a.$.userInfo.uid,cursor:0};for(;performance.now()-s<5e3;){const t=await(0,o.Js)(r).catch((()=>null));if(null!=t&&t.effect_item_list){const s=new Set(t.effect_item_list.map((e=>e.common_attr.id)));if(e.every((e=>s.has(e))))return}await n.timeout(500)}}}},80697:(e,t,s)=>{s.d(t,{Z:()=>n});const n={tag:"tag-ZaY7YS",selected:"selected-umR1Vs",disabled:"disabled-A37DzB"}},6059:(e,t,s)=>{s.d(t,{Z:()=>n});const n={block:"block-smxiey",title:"title-aqS4Cg",content:"content-IyBLdN",loading:"loading-QuFv_G",text:"text-ukrQOj"}},95331:(e,t,s)=>{s.d(t,{Z:()=>n});const n={tagSelect:"tagSelect-KEPqcU",dropItem:"dropItem-bpnHuZ",suggestListDropdown:"suggestListDropdown-fV0lMc"}}}]);